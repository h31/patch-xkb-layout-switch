version: 2
jobs:
  build:

    working_directory: ~/patch-xkb-layout-switch

    docker:

      - image: ubuntu:xenial

    steps:

      - checkout

      - run:
          command: |
            apt update
            apt upgrade
            apt install --yes lsb-release sudo wget
            sed -i '$ d' ~/patch-xkb-layout-switch/apt/patch-xkb-layout-switch.sh

      - run:
          command: ./patch-xkb-layout-switch.sh
          working_directory: ~/patch-xkb-layout-switch/apt

      - run: cp ~/patch-xkb-layout-switch/apt/xorg-server/xserver-xorg-core-hwe-16.04_* ~/xserver-xorg-core-hwe-16.04.deb

      - store_artifacts:
          path: ~/xserver-xorg-core-hwe-16.04.deb
